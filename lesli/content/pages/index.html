<html data-ng-app="fantasyApp">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="shortcut icon" href="../../etc/images/persik.png" type="image/x-icon" />
        <title>Lesli 2005</title>

        <link rel="stylesheet" href="../../etc/styles/main.css" />
        <link rel="stylesheet" href="../../etc/styles/loader.css" />
        <link rel="stylesheet" href="../../etc/styles/table.css" />

        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script>
        <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript" src="../../etc/scripts/controllers/mainController.js"></script>
    </head>
    <body data-ng-controller="mainController" data-ng-init="init()">
        <div data-ng-if="!isLoaded" class="lds-default"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>
            <p>Loading...</p>
        </div>
        <div >
            <div class="navigation_wrapper">
                <div class="year_wrapper">
                    <span>Период:</span>
                    <div data-ng-class="{'active': activeYear === 1}" class="year" data-ng-click="setYear(1)">
                        <p>1</p>
                    </div>
                    <div data-ng-class="{'active': activeYear === 3}" class="year" data-ng-click="setYear(3)">
                        <p>3</p>
                    </div>
                    <div data-ng-class="{'active': activeYear === 5}" class="year" data-ng-click="setYear(5)">
                        <p>5</p>
                    </div>
                </div>
                <div class="navigation" data-ng-click="showCompany()">
                    <p data-ng-class="{'active': activeTab === 'company'}">Компании</p>
                </div>
                <div class="navigation" data-ng-click="showProduct()">
                    <p data-ng-class="{'active': activeTab === 'product'}">Продукты</p>
                </div>
                <div class="navigation" data-ng-click="showStats()">
                    <p data-ng-class="{'active': activeTab === 'stats'}">Статистика</p>
                </div>
                <div class="navigation inactive" data-ng-click="showTopCompany1()">
                    <p data-ng-class="{'active': activeTab === 'topCompany'}">Топ 10 Клиентов</p>
                </div>
                <div class="navigation inactive">
                    <p>Топ 10 Товаров</p>
                </div>
                <div class="navigation inactive">
                    <p>Анализ</p>
                </div>
                <div class="navigation inactive">
                    <p>Обновление</p>
                </div>
            </div>
            <div data-ng-if="activeTab !== 'stats' && isLoaded" class="items_wrapper">
                <div class="table_scroll">
                    <table class="table">
                        <thead>
                            <tr>
                                <th rowspan="2">#</th>
                                <th rowspan="2"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'name'}"
                                    data-ng-click="orderByField('name')">{{title}}</th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2019].total'}"
                                    data-ng-click="orderByField('data[2019].total')"
                                    rowspan="2">2019
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    colspan="13">
                                    2020
                                </th>
                                <th colspan="13">
                                    2021
                                </th>
                            </tr>
                            <tr>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Jan'}"
                                    data-ng-click="orderByField('data[2020].Jan')">Jan
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Feb'}"
                                    data-ng-click="orderByField('data[2020].Feb')">Feb
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Mar'}"
                                    data-ng-click="orderByField('data[2020].Mar')">Mar
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Apr'}"
                                    data-ng-click="orderByField('data[2020].Apr')">Apr
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].May'}"
                                    data-ng-click="orderByField('data[2020].May')">May
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Jun'}"
                                    data-ng-click="orderByField('data[2020].Jun')">Jun
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Jul'}"
                                    data-ng-click="orderByField('data[2020].Jul')">Jul
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Aug'}"
                                    data-ng-click="orderByField('data[2020].Aug')">Aug
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Sep'}"
                                    data-ng-click="orderByField('data[2020].Sep')">Sep
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Oct'}"
                                    data-ng-click="orderByField('data[2020].Oct')">Oct
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Nov'}"
                                    data-ng-click="orderByField('data[2020].Nov')">Nov
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].Dec'}"
                                    data-ng-click="orderByField('data[2020].Dec')">Dec
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-if="activeYear === 3"
                                    data-ng-class="{'activeOrderField': currentOrderName === 'data[2020].total'}"
                                    data-ng-click="orderByField('data[2020].total')">Итого
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Jan'}"
                                    data-ng-click="orderByField('data[2021].Jan')">Jan
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Feb'}"
                                    data-ng-click="orderByField('data[2021].Feb')">Feb
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Mar'}"
                                    data-ng-click="orderByField('data[2021].Mar')">Mar
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Apr'}"
                                    data-ng-click="orderByField('data[2021].Apr')">Apr
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].May'}"
                                    data-ng-click="orderByField('data[2021].May')">May
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Jun'}"
                                    data-ng-click="orderByField('data[2021].Jun')">Jun
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Jul'}"
                                    data-ng-click="orderByField('data[2021].Jul')">Jul
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Aug'}"
                                    data-ng-click="orderByField('data[2021].Aug')">Aug
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Sep'}"
                                    data-ng-click="orderByField('data[2021].Sep')">Sep
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Oct'}"
                                    data-ng-click="orderByField('data[2021].Oct')">Oct
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Nov'}"
                                    data-ng-click="orderByField('data[2021].Nov')">Nov
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].Dec'}"
                                    data-ng-click="orderByField('data[2021].Dec')">Dec
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                                <th data-ng-class="{'activeOrderField': currentOrderName === 'data[2021].total'}"
                                    data-ng-click="orderByField('data[2021].total')">Итого
                                    <i data-ng-class="{'down': isDescOrder,  'up': !isDescOrder}" class="arrow"></i>
                                </th>
                            </tr>
                        </thead>
                        <tr data-ng-repeat="object in itemList | limitTo:quantity">
                            <td>{{$index + 1}}</td>
                            <td>{{object.name}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2019'].total}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Jan}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Feb}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Mar}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Apr}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].May}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Jun}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Jul}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Aug}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Sep}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Oct}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Nov}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].Dec}}</td>
                            <td data-ng-if="activeYear === 3">{{object.data['2020'].total}}</td>
                            <td>{{object.data['2021'].Jan}}</td>
                            <td>{{object.data['2021'].Feb}}</td>
                            <td>{{object.data['2021'].Mar}}</td>
                            <td>{{object.data['2021'].Apr}}</td>
                            <td>{{object.data['2021'].May}}</td>
                            <td>{{object.data['2021'].Jun}}</td>
                            <td>{{object.data['2021'].Jul}}</td>
                            <td>{{object.data['2021'].Aug}}</td>
                            <td>{{object.data['2021'].Sep}}</td>
                            <td>{{object.data['2021'].Oct}}</td>
                            <td>{{object.data['2021'].Nov}}</td>
                            <td>{{object.data['2021'].Dec}}</td>
                            <td>{{object.data['2021'].total}}</td>
                        </tr>
                    </table>
                </div>
            </div>
            <div data-ng-show="activeTab === 'stats' && isLoaded" id="curve_chart" class="curveChart"></div>
        </div>
    </body>
</html>